<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta name="theme-color" content="#91D4DA">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>阔壹搜</title>
    <link rel="stylesheet" href="assets/stylesheets/index.css" />
    <link rel="stylesheet" href="assets/stylesheets/weui.css">
    <link rel="stylesheet" href="assets/stylesheets/jquery-weui.css">
    <script src="assets/js/picker.min.js"></script>
</head>
<body>
<div class="search-container">
    <div class="header-container">
        <div class="header">
            <a class="index" href="index.html">
                <img src="assets/images/index.png" alt="">
            </a>
            <a href="search.html" class="search-link">
                <div class="search-input">
                    <img src="assets/images/search-input.png" alt="">
                    <input id="search" type="text" placeholder="搜索片区、小区、品牌公寓名">
                    <span class="cancel">+</span>
                </div>
            </a>


        </div>
        <div class="select-container">
            <div class="select">
                <span id="city">深圳</span>
            </div>
            <div class="select">
                <span id="type">户型</span>
            </div>
            <div class="select">
                <span id="price">价格</span>
            </div>
            <div class="select">
                <span id="brand">品牌</span>
            </div>
        </div>
    </div>
    <div class="order-content" id="list">
        <div id="content">
            <div style="min-height: 479px; pointer-events: auto; overflow: hidden" class="hotel-list">
                <div class="order-item weui-panel weui-panel_access">
                    <div class="weui-panel__bd">
                        <a href="sourcedetailrent.html" class="weui-media-box weui-media-box_appmsg">
                            <div class="weui-media-box__hd">
                                <img class="lazy weui-media-box__thumb" data-original="assets/images/my-order.png">
                            </div>
                            <div class="weui-media-box__bd">
                                <h4 class="weui-media-box__title">万科大厦A座A-1户型</h4>
                                <h5 class="hotel-house">3室2厅2卫/朝南/120㎡</h5>
                                <div class="price-time">
                                    <div class="hotel-price">￥1500元</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="order-item weui-panel weui-panel_access">
                    <div class="weui-panel__bd">
                        <a href="sourcedetailrent.html" class="weui-media-box weui-media-box_appmsg">
                            <div class="weui-media-box__hd">
                                <img class="lazy weui-media-box__thumb" data-original="assets/images/house4.png">
                            </div>
                            <div class="weui-media-box__bd">
                                <h4 class="weui-media-box__title">万科大厦A座A-1户型</h4>
                                <h5 class="hotel-house">3室2厅2卫/朝南/120㎡</h5>
                                <div class="price-time">
                                    <div class="hotel-price">￥1500元</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="order-item weui-panel weui-panel_access">
                    <div class="weui-panel__bd">
                        <a href="sourcedetailrent.html" class="weui-media-box weui-media-box_appmsg">
                            <div class="weui-media-box__hd">
                                <img class="lazy weui-media-box__thumb" data-original="assets/images/house5.png">
                            </div>
                            <div class="weui-media-box__bd">
                                <h4 class="weui-media-box__title">万科大厦A座A-1户型</h4>
                                <h5 class="hotel-house">3室2厅2卫/朝南/120㎡</h5>
                                <div class="price-time">
                                    <div class="hotel-price">￥1500元</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="order-item weui-panel weui-panel_access">
                    <div class="weui-panel__bd">
                        <a href="sourcedetailrent.html" class="weui-media-box weui-media-box_appmsg">
                            <div class="weui-media-box__hd">
                                <img class="lazy weui-media-box__thumb" data-original="assets/images/house4.png">
                            </div>
                            <div class="weui-media-box__bd">
                                <h4 class="weui-media-box__title">万科大厦A座A-1户型</h4>
                                <h5 class="hotel-house">3室2厅2卫/朝南/120㎡</h5>
                                <div class="price-time">
                                    <div class="hotel-price">￥1500元</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="order-item weui-panel weui-panel_access">
                    <div class="weui-panel__bd">
                        <a href="sourcedetailrent.html" class="weui-media-box weui-media-box_appmsg">
                            <div class="weui-media-box__hd">
                                <img class="lazy weui-media-box__thumb" data-original="assets/images/house5.png">
                            </div>
                            <div class="weui-media-box__bd">
                                <h4 class="weui-media-box__title">万科大厦A座A-1户型</h4>
                                <h5 class="hotel-house">3室2厅2卫/朝南/120㎡</h5>
                                <div class="price-time">
                                    <div class="hotel-price">￥1500元</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="weui-loadmore">
                <i class="weui-loading"></i>
                <span class="weui-loadmore__tips">正在加载</span>
            </div>
        </div>
    </div>

    <div class="weui-tabbar">
        <a href="home.html" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="assets/images/home-selected.png" alt="">
            </div>
            <p class="weui-tabbar__label selected">阔壹搜</p>
        </a>
        <a href="hotel.html" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="assets/images/apartment.png" alt="">
            </div>
            <p class="weui-tabbar__label">品牌公寓</p>
        </a>
        <a href="../person/my.html" class="weui-tabbar__item">
            <div class="weui-tabbar__icon">
                <img src="assets/images/my.png" alt="">
            </div>
            <p class="weui-tabbar__label">我的</p>
        </a>
    </div>
</div>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/fastclick.js"></script>
<script src="assets/js/jquery-weui.js"></script>
<!--<script src="assets/js/lazyload.min.js"></script>-->
<!--<script src="assets/js/iscroll.js"></script>-->
<script src="assets/js/bscroll.min.js"></script>

<script>
  $(document).ready(function(){
    // $(".lazy").lazyload();
    // $(function() {
    //   FastClick.attach(document.body);
    // });
    var scroll;
    var wrapper = document.querySelector('#list');
    scroll = new BScroll(wrapper,
      {
        tap: true,
        click: true,
        pullUpLoad: {
          threshold: 50,
        },
      });
    $('.weui-loadmore').hide();
    var loading = false;
    scroll.on("scroll", function (pos) {
      console.log(pos);
    });
    function onPullingUp() {
      $('.weui-loadmore').css('display', 'block');
      console.log(scroll);
      if(loading) return;
      loading = true;
      console.log('success');
      setTimeout(function() {
        console.log(loading);
        console.log('success');
        loading = false;
        $('.weui-loadmore').hide();
      }, 2000);
    }
    scroll.on("pullingUp", onPullingUp);

    console.log(scroll);
    $("#search").focus(function(){
//      window.location.pathname="/my/home/search.html"
    });
    var cityLeftData = [{
      text: '附近',
      value: 'fj'
    },{
      text: '区域',
      value: 'qy'
    },{
      text: '广东省',
      value: 'gd'
    },{
      text: '福建省',
      value: 'fj'
    },{
      text: '广西省',
      value: 'gx'
    },{
      text: '福建省',
      value: 'fj'
    },{
      text: '广西省',
      value: 'gx'
    }];
    var cityData = [
      [{
        text: '不限',
        value: 'bx'
      },{
        text: '1KM',
        value: '1k'
      },{
        text: '1.5KM',
        value: '1m'
      },{
        text: '2KM',
        value: '2m'
      }],
      [{
        text: '不限',
        value: 'jn'
      },{
        text: '罗湖区',
        value: 'sl'
      },{
        text: '南山区',
        value: 'gx'
      },{
        text: '宝安区',
        value: 'wh'
      },{
        text: '福田区',
        value: 'xd'
      }],
      [{
        text: '广州市',
        value: 'gz'
      }],
      [{
        text: '福州市',
        value: 'fz'
      }],
      [{
        text: '桂林市',
        value: 'gl'
      }],
      [{
        text: '福州市',
        value: 'fz'
      }],
      [{
        text: '桂林市',
        value: 'gl'
      }]
    ];
    var areaData = [
      [[],[],[],[]],
      [
        [],
        [{
          text: '不限',
          value: 'jn'
        },{
          text: '百仕达',
          value: 'sl'
        },{
          text: '布心',
          value: 'gx'
        },{
          text: '春风路',
          value: 'wh'
        },{
          text: '翠竹',
          value: 'xd'
        }]
      ],
      [
        [{
          text: '广州市',
          value: 'gz'
        }]
      ],
      [
        [{
          text: '福州市',
          value: 'fz'
        }]
      ],
      [
        [{
          text: '桂林市',
          value: 'gl'
        }]
      ],
      [
        [{
          text: '福州市',
          value: 'fz'
        }]
      ],
      [
        [{
          text: '桂林市',
          value: 'gl'
        }]
      ]
    ];
    var typeData = [{
      text: '单间',
      value: 'fj'
    },{
      text: '一室一厅',
      value: 'qy'
    },{
      text: '二室一厅',
      value: 'gd'
    },{
      text: '四室二厅',
      value: 'fj'
    },{
      text: '五房',
      value: 'gx'
    },{
      text: '别墅',
      value: 'fj'
    }];
    var priceData = [{
      text: '不限',
      value: 'fj'
    },{
      text: '600元以下',
      value: 'qy'
    },{
      text: '600-1000元',
      value: 'gd'
    },{
      text: '1000-1500元',
      value: 'fj'
    },{
      text: '1500-2000元',
      value: 'gx'
    }, {
      text: '2000元以上',
      value: 'gx'
    }]
    var brandData = [{
      text: '阔以',
      value: 'fj'
    },{
      text: '如家',
      value: 'qy'
    }]
    function tPicker(options) {
      this.data = options.data;
      this.el = options.el;
      this.value = '';
      this.init();
    }
    tPicker.prototype = {
      init: function () {
        this.createDom();
      },
      createDom: function () {
        var that = this;
        this.picker = $('<div class="tpicker"></div>');
        if(this.data.length) {
          var leftData = this.data[0];

          var leftBox = $('<ul class="left"></ul>');
          this.left = leftBox;

          $(leftData).each(function (i, obj) {
            console.log(i)
            var liLeft = $('<li></li>').html(obj.text).attr('val', i).appendTo(leftBox);
            if(i == 0) {
              liLeft.addClass('active');
            }
          })
          leftBox.on('click', function (e) {
            if(e.target.tagName.toUpperCase() === 'LI') {
                $(e.target).addClass('active').siblings().removeClass('active');
                var leftVal = $(e.target).html();
                console.log(leftVal)
              $(that.el).html(leftVal);
              setTimeout(function () {
                leftBox.unbind('click');
                that.hide();
              }, 300);
            }
          })
          console.log(leftBox)
          var leftScroll = $('<div id="leftScroll" class="scroll"></div>');
          leftBox.appendTo(leftScroll);
          leftScroll.appendTo(this.picker);
        }
      },
      createMask: function () {
        var that = this;
        console.log($('.tpicker-mask').length)
        if($('.tpicker-mask').length) {
          $('.tpicker-mask').show();
          this.mask = $('.tpicker-mask');
          return;
        };
        this.mask = $('<div class="tpicker-mask"></div>');
        $('#content').append(this.mask);
        this.mask.on('click', function () {
          that.hide();
        })
      },
      updateRight: function(index) {
        var that = this;
        if(!index) index = 0;
        var rightData = this.data[1][index];
        $('.picker #rightScroll').remove();
        var rightBox = $('<ul class="right"></ul>');
        this.right = rightBox;
        $(rightData).each(function (i, obj) {
          console.log(i)
          $('<li></li>').html(obj.text).attr('val', obj.value).appendTo(rightBox);
        })
        rightBox.on('click', function (e) {
          console.log(e.target)
          if(e.target.tagName.toUpperCase() === 'LI') {
            $(e.target).addClass('active').siblings().removeClass('active');
            var rightVal = $(e.target).attr('val');
            var rightText = $(e.target).html();
            that.value = rightVal;
            console.log($(that.el))
            $(that.el).html(rightText);
            setTimeout(function () {
              that.hide();
            }, 300)
          }
        })
        var rightScroll = $('<div id="rightScroll" class="scroll"></div>');
        rightBox.appendTo(rightScroll);
        rightScroll.appendTo(this.picker)
      },
      show: function () {
        $(document.body).append(this.picker);
        var leftscroll = new IScroll('#leftScroll', { mouseWheel: true, click: true, probeType: 2 });
        this.createMask();
      },
      hide: function () {
        this.picker.remove();
        this.mask.hide();
      }
    }
    // var cityPicker = new Picker({
    //   data: [cityLeftData, cityData[0], areaData[0][0]],
    // });

    // $("#city").click(function () {
    //   cityPicker.show();
    // })
    // var currentOneIndex = 0;
    // var currentTwoIndex = 0;
    // cityPicker.on('picker.change', function (index, selectedIndex) {
    //     //当一列滚动停止的时候，会派发picker.change事件，同时会传递列序号index及滚动停止的位置selectIndex。
    //   console.log(index, selectedIndex)
    //   if(index === 0) {
    //     currentOneIndex = selectedIndex;
    //     cityPicker.refillColumn(1, cityData[selectedIndex])
    //     cityPicker.refillColumn(2, areaData[index][0])
    //   } else if(index === 1){
    //     currentTwoIndex = selectedIndex;
    //     console.log(areaData[currentOneIndex][selectedIndex])
    //     cityPicker.refillColumn(2, areaData[currentOneIndex][selectedIndex])
    //   }
    //
    // })
    // cityPicker.on('picker.select', function (selectedVal, selectedIndex) {
    //   console.log(selectedVal, selectedIndex)
    //   var index = selectedVal.length - 1;
    //   var targetVal = '';
    //   if(selectedVal[2]) {
    //     targetVal = areaData[selectedIndex[0]][selectedIndex[1]][selectedIndex[2]]
    //   } else {
    //     targetVal = cityData[selectedIndex[0]][selectedIndex[1]]
    //   }
    //   console.log(targetVal)
    //   $('#city').text(targetVal.text)
    // })
    // $("#type").click(function () {
    //   var typePicker = new tPicker({
    //     data: [typeData],
    //     el: '#type',
    //   })
    //   typePicker.show();
    // })
    // $("#price").click(function () {
    //   var pricePicker = new tPicker({
    //     data: [priceData],
    //     el: '#price',
    //   })
    //   pricePicker.show();
    // })
    // $("#brand").click(function () {
    //   var brandPicker = new tPicker({
    //     data: [brandData],
    //     el: '#brand',
    //   })
    //   brandPicker.show();
    // })
  });
</script>
</body>
</html>
